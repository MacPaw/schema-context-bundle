services:
  _defaults:
    autowire: true
    autoconfigure: true
    public: false

  Macpaw\SchemaContextBundle\Service\BaggageSchemaResolver:
    arguments:
      $environmentSchema: '%schema_context.environment_schema%'
      $environmentName: '%schema_context.environment_name%'
      $schemaOverridableEnvironments: '%schema_context.overridable_environments%'
    public: true
    shared: true

  Macpaw\SchemaContextBundle\Service\BaggageCodec:
    public: true
    shared: true

  Macpaw\SchemaContextBundle\EventListener\BaggageRequestListener:
    arguments:
      $baggageSchemaResolver: '@Macpaw\SchemaContextBundle\Service\BaggageSchemaResolver'
      $schemaRequestHeader: '%schema_context.header_name%'
    tags:
      - { name: kernel.event_subscriber }

  Macpaw\SchemaContextBundle\Messenger\Middleware\BaggageSchemaMiddleware:
    arguments:
      $sendersLocator: '@messenger.senders_locator'
    tags:
      - { name: messenger.middleware }
